// === dsc_settings.lsl ===
// Settings plugin for DS Collar (DSC)

integer LM_SETTING_REQUEST     = -5000;
integer LM_SETTING_RESPONSE    = -5001;
integer LM_SETTING_SAVE        = -5002;
integer LM_SETTING_DELETE      = -5003;

integer LM_PLUGIN_REG_REQUEST  = -7000;
integer LM_PLUGIN_REG_RESPONSE = -7001;

integer LM_MENU_RESPONSE       = -4001;

key g_owner = NULL_KEY;

list g_settings_keys = [];
list g_settings_values = [];

default
{
    state_entry()
    {
        llOwnerSay("[SETTINGS] Plugin initialized and listening.");
        llMessageLinked(LINK_SET, LM_PLUGIN_REG_REQUEST, "", NULL_KEY);
    }

    link_message(integer sender, integer num, string msg, key id)
    {
        if (num == LM_PLUGIN_REG_REQUEST)
        {
            string reg_msg = "Settings|dsc_settings|0|Backend";
            llMessageLinked(LINK_SET, LM_PLUGIN_REG_RESPONSE, reg_msg, NULL_KEY);
            return;
        }

        if (num == LM_MENU_RESPONSE)
        {
            // Ignore menu responses here
            return;
        }

        if (num == LM_SETTING_SAVE)
        {
            // Save setting logic here (not shown)
        }
        else if (num == LM_SETTING_REQUEST)
        {
            // Setting request logic here (not shown)
        }
        else if (num == LM_SETTING_DELETE)
        {
            // Delete setting logic here (not shown)
        }
        else
        {
            llOwnerSay("[SETTINGS] Unhandled link_message: num=" + (string)num + " msg=" + msg);
        }
    }
}
